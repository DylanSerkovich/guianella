<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Producción</title>
    <th:block th:replace="fragments/head :: baseContent"></th:block>
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
  </head>
  <body class="sb-nav-fixed">
    <nav th:replace="@{/fragments/navbar} :: navbar"></nav>
    <div id="layoutSidenav">
      <div th:replace="@{/fragments/menu} :: menu"></div>
      <div id="layoutSidenav_content">
        <main>
          <div class="container-fluid px-xl-4">
            <ol class="breadcrumb mb-4 mt-4">
              <li class="breadcrumb-item">
                <a href="index.html">Dashboard</a>
              </li>
              <li class="breadcrumb-item active">Estimación de beneficios</li>
            </ol>
            <div class="card mb-4">
              <div class="card-header">
                <i class="fas fa-table me-1"></i>
                Calculo de Estimación de beneficios
              </div>
              <div class="card-body">
                <form>
                  <div class="row">
                    <div
                      class="col-xxl-4 col-xl-4 col-md-6 col-sm-6 col-re-12 mb-2"
                    >
                      <select
                        class="form-select"
                        aria-label="Default select example"
                        name="inversion"
                        id="inversion"
                        placeholder="Escoge una inversion..."
                      >
                        <option selected hidden th:value="${''}">
                          Elija una inversion
                        </option>
                        <option
                          th:each="inversion: ${inversiones}"
                          th:value="${inversion.idInversion}"
                          th:text="${inversion.nameInvestor} + ' ' +${#dates.format(inversion.dateRecord, 'dd-MM-yyyy HH:mm')}"
                        >
                          Inversión 1
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="container">
                      <div class="row pt-3">
                        <div class="col-md-4 col-sm-12 col-12 p-2">
                          <div class="row">
                            <div
                              class="col-xxl-6 col-xl-6 col-md-12 col-sm-6 col-re-12"
                            >
                              <div class="form-floating mb-3">
                                <input
                                  type="number"
                                  step="0.01"
                                  class="form-control"
                                  aria-label="Sizing example input"
                                  id="servicePolo"
                                  placeholder="Tamaño de Trazo"
                                  aria-describedby="inputGroup-sizing-sm"
                                />
                                <label for="servicePolo">Servicio Polo</label>
                              </div>
                            </div>
                            <div
                              class="col-xxl-6 col-xl-6 col-md-12 col-sm-6 col-re-12"
                            >
                              <div class="form-floating mb-3">
                                <input
                                  type="number"
                                  step="0.01"
                                  class="form-control"
                                  aria-label="Sizing example input"
                                  id="cortaCinta"
                                  placeholder="Tamaño de Trazo"
                                  aria-describedby="inputGroup-sizing-sm"
                                />
                                <label for="cortaCinta"
                                  >Servicio Cortacinta</label
                                >
                              </div>
                            </div>
                            <div
                              class="col-xxl-6 col-xl-6 col-md-12 col-sm-6 col-re-12"
                            >
                              <div class="form-floating mb-3">
                                <input
                                  type="number"
                                  step="0.01"
                                  class="form-control"
                                  aria-label="Sizing example input"
                                  id="serviceBoton"
                                  placeholder="Tamaño de Trazo"
                                  aria-describedby="inputGroup-sizing-sm"
                                />
                                <label for="serviceBoton">Servicio Boton</label>
                              </div>
                            </div>
                            <div
                              class="col-xxl-6 col-xl-6 col-md-12 col-sm-6 col-re-12"
                            >
                              <div class="form-floating mb-3">
                                <input
                                  type="number"
                                  step="0.01"
                                  class="form-control"
                                  aria-label="Sizing example input"
                                  id="costBoton"
                                  placeholder="Tamaño de Trazo"
                                  aria-describedby="inputGroup-sizing-sm"
                                />
                                <label for="costBoton">Costo Boton</label>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-8 col-sm-12 col-12 p-2">
                          <div class="text-right pb-3">
                            <input
                              type="button"
                              id="btnAdd"
                              class="btn btn-primary para"
                              value="Agregar Modelo"
                            />
                          </div>
                          <table
                            id="tblData"
                            class="table table-responsive table-bordered table-hover table-striped"
                          >
                            <thead>
                              <tr>
                                <th>Descripción</th>
                                <th>Cantidad</th>
                                <th>Precio/Venta</th>
                                <th class="tdaction">Action</th>
                              </tr>
                            </thead>
                            <tbody></tbody>
                          </table>
                          <button
                            type="button"
                            class="btn btn-info"
                            id="produccion"
                          >
                            Agregar
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
            <!-- <div style="height: 100vh"></div> -->
          </div>
        </main>
        <footer class="py-4 bg-light mt-auto">
          <div class="container-fluid px-4">
            <div
              class="d-flex align-items-center justify-content-between small"
            >
              <div class="text-muted">Copyright &copy; Your Website 2023</div>
              <div>
                <a href="#">Privacy Policy</a>
                &middot;
                <a href="#">Terms &amp; Conditions</a>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>
    <script th:src="@{/js/scripts.js}"></script>
    <script>
      var emptyRow =
        "<tr><td colspan='4' class='text-center'> No Records Available</td></tr>";
      var emptyNewRow = `
        <tr class='trNewRow'>
            <td class='tdDescription'>
              <input type='text' class='form-control txtDescription' placeholder='Ingresar Nombre'/>
            </td>
            <td class='tdNumber'>
              <input type='text' class='form-control txtNumber' placeholder='Ingresar Cantidad'/>
            </td>
            <td class='tdPrice'>
              <input type='text' class='form-control txtPrice' placeholder='Ingresar Precio'/>
            </td>
            <td class='tdAction'>
              <button class='btn btn-sm btn-success btn-save'>Save</button>
              <button class='btn btn-sm btn-success btn-cancel'>Cancel</button>
            </td>
        </tr>`;

      var rowButtons =
        "<button class='btn btn-success btn-sm btn-edit' > Edit </button>  <button class='btn btn-danger btn-sm' > Delete </button> ";
      var rowUpdateButtons =
        "<button class='btn btn-success btn-sm btn-save' > Update </button>  <button class='btn btn-danger btn-sm btn-save' > Cancel </button> ";

      const $tblDataBody = $("#tblData tbody");
      $(document).ready(function () {
        $("#tblData tbody").append(emptyRow); // adding empty row on page load

        $("#btnAdd").click(function () {
          if ($("#tblData tbody").children().children().length == 1) {
            $("#tblData tbody").html("");
          }
          $("#tblData tbody").append(emptyNewRow); // appending dynamic string to table tbody
        });

        $("#tblData").on("click", ".btn-save", function () {
          const description = $(this)
            .parent()
            .parent()
            .find(".txtDescription")
            .val();
          $(this)
            .parent()
            .parent()
            .find(".tdDescription")
            .html("" + description + "");
          const number = $(this).parent().parent().find(".txtNumber").val();
          $(this)
            .parent()
            .parent()
            .find(".tdNumber")
            .html("" + number + "");
          const price = $(this).parent().parent().find(".txtPrice").val();
          $(this)
            .parent()
            .parent()
            .find(".tdPrice")
            .html("" + price + "");
          $(this).parent().parent().find(".tdAction").html(rowButtons);
        });

        $("#tblData").on("click", ".btn-danger", function () {
          // registering function for delete button
          $(this).parent().parent().remove();
          if ($("#tblData tbody").children().children().length == 0) {
            $("#tblData tbody").append(emptyRow);
          }
        });

        $("#tblData").on("click", ".btn-cancel", function () {
          $(this).parent().parent().remove();
        });

        $("#tblData").on("click", ".btn-edit", function () {
          const name = $(this).parent().parent().find(".tdDescription").html();

          $(this)
            .parent()
            .parent()
            .find(".tdDescription")
            .html(
              "<input type='text' value='" +
                name +
                "' class='form-control txtDescription' placeholder='Ingresar Producto'/>"
            );

          const city = $(this).parent().parent().find(".tdNumber").html();

          $(this)
            .parent()
            .parent()
            .find(".tdNumber")
            .html(
              "<input type='text' value='" +
                city +
                "' class='form-control txtNumber' placeholder='Ingresar Cantidad'/>"
            );

          const mobile = $(this).parent().parent().find(".tdPrice").html();

          $(this)
            .parent()
            .parent()
            .find(".tdPrice")
            .html(
              "<input type='text' value='" +
                mobile +
                "' class='form-control txtPrice' placeholder='Ingresar Precio'/>"
            );
          $(this).parent().parent().find(".tdAction").html(rowUpdateButtons);
        });
      });
    </script>
    <script th:src="@{/js/request/production.js}"></script>
  </body>
</html>
